---
import { type CollectionEntry, render } from 'astro:content';
import { getAllNewsPosts } from '../../features/news/services/news';
import ContentLayout from '../../layouts/ContentLayout.astro';

export async function getStaticPaths() {
  const posts = await getAllNewsPosts();
  return posts.map((post) => ({
    params: { slug: post.id },
    props: { post },
  }));
}

type Props = { post: CollectionEntry<'news'> };
const { post } = Astro.props;
const { Content } = await render(post);

// Use a simplified excerpt or description for SEO if available, or post.data.title
const description = post.data.description || post.data.title;
const ogImage =
  post.data.image ||
  (post.data.photos && post.data.photos.length > 0
    ? post.data.photos[0]
    : undefined);
---

<ContentLayout entry={post} description={description} ogImage={ogImage}>
  <Content />
</ContentLayout>
